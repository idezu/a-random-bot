some code from Roboliam by Controlfreak707